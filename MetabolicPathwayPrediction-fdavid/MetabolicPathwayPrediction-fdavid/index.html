<!DOCTYPE html>
<!--
  ~ This file is part of the Metabolic Pathway Prediction Pipeline.
  ~ It processes the data coming from a javascript and represents
  ~ the data with the visualization tools NVD3 and DataTables for
  ~ better comprehensibility.
  -->
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="FD/VK/VK/SL">

    <title> MetaPathPrediction </title>

    <!--------------------------------------------------------------------------------------------------------
    ~ ALL REQUIRED LOCAL SCRIPTS AND SHEETS FOR PROCESSING DATA WITH VISUALIZATION TOOLS NVD3 AND DATATABLES
    ~ LICENSE INFORMATION ARE TO BE TAKEN FROM THE CORRESPONDING SCRIPTS AND SHEETS
    --------------------------------------------------------------------------------------------------------->
    <!-- DataTables stylesheet for implementation along with bootstrap framework -->
    <link rel="stylesheet" type="text/css" href="styles/dataTables.bootstrap4.min.css">
    <!-- jquery required both for nvd3 and DataTables and additional Datatables jquery script -->
    <script src="scripts/framework/jquery331.js"></script>
    <script type="text/javascript" charset="utf8" src="scripts/framework/jquery.dataTables.js"></script>
    <!-- scripts for bootstrap framework -->
    <link rel="stylesheet" href="styles/bootstrap.css">
    <script src="scripts/framework/bootstrap.bundle.min.js"></script> <!-- needed for table tabs -->
    <script type="text/javascript" charset="utf8" src="scripts/framework/dataTables.bootstrap.js"></script>
    <!-- scripts for visualization tool nvd3  as well as the required d3 library-->
    <link rel="stylesheet" href="styles/nvd3_181.css">
    <script src="scripts/framework/d3v3.js"></script>
    <script src="scripts/framework/nvd3_181.js"></script>

    <!--------------------------------------------------------------------------------------------------------
    ~ RESULTS FROM PREDICTION PIPELINE AND REQUIRED SCRIPTS FOR REPRESENTATION TO WORK WITH CORRESPONDING
    ~ VISUALIZATION TOOLS
    --------------------------------------------------------------------------------------------------------->
    <!-- Custom .css file -->
    <link rel="stylesheet" href="styles/styles.css">
    <!-- Full Pipeline Data -->
    <script src="scripts/full.js"></script>
    <!-- Graph and table functions -->
    <script src="scripts/drawPathwayTable.js"></script>
    <script src="scripts/drawSunburstGraph.js"></script>
    <script src="scripts/drawHorizontalBarChart.js"> </script>
</head>

<body id="mpPrediction" data-spy="scroll" data-target=".navbar" data-offset="60">

<!---------------------------------------------------------------------------------------------------
~ FIXED NAVIGATION BAR
-- -------------------------------------------------------------------------------------------------->
<nav class="navbar navbar-default navbar-fixed-top">
    <div class="container-fluid">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="#mpPrediction">Start</a>
        <div class="collapse navbar-collapse" id="myNavbar">
            <ul class="nav navbar-nav navbar-right">
                <li><a href="#parameters">INFO</a></li>
                <li><a href="#summary">SUMMARY</a></li>
                <li><a href="#details">DETAILS</a></li>
                <li><a href="#accessoryPathways">ACCESSORY PATHWAYS</a></li>
            </ul>
        </div>
    </div>
</nav>

<!---------------------------------------------------------------------------------------------------
~ JUMBOTRON CONTAINING HEADER
---------------------------------------------------------------------------------------------------->
<div class="jumbotron mb-0">
    <h1> Metabolic Pathway Prediction </h1>
    <p> Report and visualization of pathways estimated by MinPath</p>
</div>

<!---------------------------------------------------------------------------------------------------
~ CONTAINER FOR INFO SECTION
---------------------------------------------------------------------------------------------------->
<div id="parameters" class="container-fluid ">
    <div class="data">
        <div class="row">
            <div class="col-sm-8">
                <h1> General information </h1>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-3">
                <h4> Analyzed species: </h4>
                <h4> Number of selected individuals: </h4>
                <h4> Local database directory: </h4>
                <h4> Prediction tool directory: </h4>
                <h4> Output directory: </h4>
            </div>
            <div class="col-sm-9">
                <h4><b id="species" style="color: #216590"></b></h4>
                <h4><b id="individuals" style="color: #216590"></b></h4>
                <h4><b id="db" style="color: #216590"></b></h4>
                <h4><b id="minpath" style="color: #216590"></b></h4>
                <h4><b id="out" style="color: #216590"></b></h4>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-12">
                <h3> Individuals for pathway prediction:</h3>
                <div class="col-sm-11" style="margin-left: 15px">
                    <h4><b id="analyzedIndividuals" style="color: #216590"></b></h4>
                </div>
            </div>
        </div>
    </div>
</div>


<!---------------------------------------------------------------------------------------------------
~ CONTAINER FOR SUMMARY SECTION
---------------------------------------------------------------------------------------------------->
<div id="summary" class="container-fluid bg-grey">
    <div class="data">
        <div class="row">
            <div class="col-sm-12">
                <h1> Summary </h1>
                <p> This graph gives an overview of the entirety of the estimated pathways, the Pan-pathways, and their distribution into Core- and
                    Accessory-pathways. Furthermore, the respective metabolism classes of the estimated individual metabolic pathways present in the analyzed individuals are shown.<br></br></p>
                <div id="sunburst">
                    <svg></svg>
                </div>
            </div>
        </div>
    </div>
</div>

<!---------------------------------------------------------------------------------------------------
~ CONTAINER FOR DETAIL SECTION WITH TABLE
---------------------------------------------------------------------------------------------------->
<div id="details" class="container-fluid">
    <div class="data">
        <div class="row">
            <div class="col-sm-12">
                <h1> Details </h1>
                <p> This table lists the entirety of the metabolic pathways estimated by MinPath in reference to the analyzed organisms. Occurring pathways in an
                    processed individual are highlighted. MinPath attempts to find the <u>minimum</u> number of pathways which explain all proteins/functions.<br></br></p>
                <div>
                    <ul class="nav nav-tabs" role="tablist">
                        <li class="active"><a href="#pantab" aria-controls="pantab" role="tab"
                                              data-toggle="tab">Pan</a></li>
                        <li><a href="#coretab" aria-controls="coretab" role="tab"
                               data-toggle="tab">Core</a></li>
                        <li><a href="#accessorytab" aria-controls="accessorytab" role="tab"
                               data-toggle="tab">Accessory</a></li>
                    </ul>
                    <div class="tab-content">
                        <div class="tab-pane active" id="pantab">
                            <table id="pathwaytable" class="table table-striped table-bordered"
                                   style="width:100%"></table>
                        </div>
                        <div class="tab-pane" id="coretab">
                            <table id="coretable" class="table table-striped table-bordered" style="width:100%"></table>
                        </div>
                        <div class="tab-pane" id="accessorytab">
                            <table id="accessorytable" class="table table-striped table-bordered"
                                   style="width:100%"></table>
                        </div>
                    </div>
                </div> <!-- End nav-tabs -->
            </div>
        </div>
    </div>
</div>

<!---------------------------------------------------------------------------------------------------
~ CONTAINER FOR SECTION WITH BARCHART REPRESENTING ACCESSORY PATHWAYS
---------------------------------------------------------------------------------------------------->
<div id="accessoryPathways" class="container-fluid bg-grey">
    <div class="data">
        <div class="row">
            <div class="col-sm-12">
                <h1> Quantity of Accessory-pathways </h1>
                <p> This graph display the estimated Accessory-pathways and the quantity of occurrence in the analyzed individuals. </p>
                <div id="horizontalBarChart">
                    <svg></svg>
                </div>
            </div>
        </div>
    </div>
</div>

<footer class="container-fluid text-center">
    <a href="#mpPrediction" title="To Top">
        <h2 class="navarrow"> ^ </h2>
    </a>
    <p> Metabolic Pathway Prediction Pipeline and Data Visualization Made By FD/VK/VK/SL <br> This webpage uses front-end framework Bootstrap, graph visualization tool NVD3 based on d3 library and DataTables plug-in for jQuery Javascript library </p>
</footer>

<script>
    /*---------------------------------------------------------------------------------------------------
    ~ SMOOTH SCROLLING WHEN CLICKING ON LINKS IN NAVBAR
    ---------------------------------------------------------------------------------------------------*/
    $(document).ready(function () {
        // Add smooth scrolling to all links in navbar + footer link
        $(".navbar a, footer a[href='#mpPrediction']").on('click', function (event) {

            // Make sure this.hash has a value before overriding default behavior
            if (this.hash !== "") {

                // Prevent default anchor click behavior
                event.preventDefault();

                // Store hash
                var hash = this.hash;

                // Using jQuery's animate() method to add smooth page scroll
                // The optional number (900) specifies the number of milliseconds it takes to scroll to the specified area
                $('html, body').animate({
                    scrollTop: $(hash).offset().top
                }, 900, function () {

                    // Add hash (#) to URL when done scrolling (default click behavior)
                    window.location.hash = hash;
                });
            } // End if
        });
    });

    /*---------------------------------------------------------------------------------------------------
    ~ GETTER FOR VALUES FOR INFO SECTION
    ---------------------------------------------------------------------------------------------------*/
    String.prototype.replaceAll = function(search, replacement) {
        var target = this;
        return target.replace(new RegExp(search, 'g'), replacement);
    };
    String.replaceAll = function(search, replacement) {
        var target = this;
        return target.replace(new RegExp(search, 'g'), replacement);
    };

    var notSuitable = params["individuals"] - allIndividuals.length;
    document.getElementById("individuals").innerHTML = params["individuals"];
    document.getElementById("species").innerHTML = params["species"].replaceAll('_', ' ').replaceAll(',', ', ');
    document.getElementById("db").innerHTML = params["db"];
    document.getElementById("out").innerHTML = params["out"];
    document.getElementById("minpath").innerHTML = params["minpath"];

    var htmlIndividuals = allIndividuals;
    document.getElementById("analyzedIndividuals").innerHTML = htmlIndividuals.toString().replaceAll(',', '<br style="margin-bottom: 5px">');
</script>

</body>
</html>
